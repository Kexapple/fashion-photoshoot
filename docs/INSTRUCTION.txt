================================================================================
                      SETUP & INSTALLATION GUIDE
              Fashion Photoshoot Studio - Complete Setup
================================================================================

This guide will walk you through setting up the entire application from
scratch, including Firebase, Nano Banana API, and deployment.

================================================================================
PART 1: FIREBASE SETUP
================================================================================

1. Create Firebase Project
   â”œâ”€ Go to: https://console.firebase.google.com
   â”œâ”€ Click: "+ Add project"
   â”œâ”€ Enter: "fashion-photoshoot-studio"
   â”œâ”€ Select: Create project
   â””â”€ Wait for creation to complete

2. Enable Authentication
   â”œâ”€ In Firebase Console, click: Authentication
   â”œâ”€ Click: "Get started"
   â”œâ”€ Select: "Email/Password"
   â”‚  â””â”€ Enable it
   â”œâ”€ Select: "Google"
   â”‚  â”œâ”€ Enable it
   â”‚  â”œâ”€ Add support email: your.email@gmail.com
   â”‚  â””â”€ Add project name
   â””â”€ Review the OAuth consent screen

3. Create Firestore Database
   â”œâ”€ Click: Firestore Database
   â”œâ”€ Click: "Create database"
   â”œâ”€ Select: "Start in test mode"
   â”‚  â””â”€ (We'll add security rules later)
   â”œâ”€ Choose: Cloud region closest to you
   â””â”€ Click: "Create"

4. Enable Cloud Storage
   â”œâ”€ Click: Storage
   â”œâ”€ Click: "Get started"
   â”œâ”€ Keep default bucket name
   â”œâ”€ Start in test mode (for development)
   â””â”€ Create bucket

5. Get Firebase Configuration
   â”œâ”€ Click: Project Settings (gear icon)
   â”œâ”€ Select: "Your apps" tab
   â”œâ”€ Click: </> (Web app)
   â”œâ”€ Register app as: "fashion-app"
   â”œâ”€ Copy the config object under "firebaseConfig"
   â””â”€ Save for later use

   Your config should look like:
   ```
   const firebaseConfig = {
     apiKey: "AIza...",
     authDomain: "project.firebaseapp.com",
     projectId: "project-id",
     storageBucket: "project.appspot.com",
     messagingSenderId: "123456789",
     appId: "1:123456789:web:abc..."
   };
   ```

6. Create Service Account Key (for Backend)
   â”œâ”€ Click: Project Settings (gear icon)
   â”œâ”€ Select: "Service accounts" tab
   â”œâ”€ Click: "Generate new private key"
   â”œâ”€ Save the JSON file as: backend/firebase-credentials.json
   â””â”€ WARNING: Keep this file secret! Never commit to Git!

================================================================================
PART 2: NANO BANANA API SETUP
================================================================================

1. Create Nano Banana Account
   â”œâ”€ Go to: https://www.nanobana.com (or your chosen image gen API)
   â”œâ”€ Sign up for free account
   â””â”€ Verify email

2. Get API Key
   â”œâ”€ Log in to dashboard
   â”œâ”€ Navigate: API Keys section
   â”œâ”€ Copy: Your API key
   â””â”€ Keep it safe!

3. Choose Model
   â”œâ”€ Browse: Available models
   â”œâ”€ Select: Model suitable for fashion/clothing
   â”œâ”€ Note down: Model ID
   â””â”€ Test generation (free credits usually provided)

4. Store API Credentials
   â”œâ”€ Add to backend/.env:
   â”‚  â”œâ”€ NANO_BANANA_API_KEY=your-key-here
   â”‚  â””â”€ NANO_BANANA_MODEL_ID=your-model-id
   â””â”€ Never commit .env file!

================================================================================
PART 3: BACKEND SETUP (FastAPI)
================================================================================

1. Install Python Dependencies
   ```
   cd backend
   pip install -r requirements.txt
   ```

2. Create Environment File
   ```
   cp .env.example .env
   ```

3. Update .env with Credentials
   ```
   nano .env
   (or use your favorite editor)
   ```

   Fill in:
   â”œâ”€ Firebase credentials (from Part 1 Step 6)
   â”œâ”€ FIREBASE_PROJECT_ID=your-project-id
   â”œâ”€ FIREBASE_STORAGE_BUCKET=your-project.appspot.com
   â”œâ”€ NANO_BANANA_API_KEY=your-api-key (from Part 2)
   â”œâ”€ NANO_BANANA_MODEL_ID=your-model-id (from Part 2)
   â”œâ”€ FRONTEND_URL=http://localhost:5173 (for local dev)
   â””â”€ BACKEND_URL=http://localhost:8000

4. Test Backend Locally
   ```
   uvicorn app.main:app --reload
   ```

   Should see:
   ```
   Uvicorn running on http://127.0.0.1:8000
   ```

5. Test API Health
   ```
   curl http://localhost:8000/health
   
   Response:
   {"status":"ok","service":"fashion-photoshoot-api"}
   ```

6. View API Documentation
   Visit: http://localhost:8000/docs
   (Interactive Swagger UI)

================================================================================
PART 4: FRONTEND SETUP (SvelteKit)
================================================================================

1. Install Node Dependencies
   ```
   cd frontend
   npm install
   ```

2. Create Environment File
   ```
   cp .env.example .env
   ```

3. Add Firebase Config to .env
   From Part 1 Step 5, add:
   ```
   VITE_FIREBASE_API_KEY=AIza...
   VITE_FIREBASE_AUTH_DOMAIN=project.firebaseapp.com
   VITE_FIREBASE_PROJECT_ID=project-id
   VITE_FIREBASE_STORAGE_BUCKET=project.appspot.com
   VITE_FIREBASE_MESSAGING_SENDER_ID=123456789
   VITE_FIREBASE_APP_ID=1:123456789:web:abc...
   VITE_BACKEND_URL=http://localhost:8000
   ```

4. Test Frontend Locally
   ```
   npm run dev
   ```

   Should see:
   ```
   VITE v5.0.0  ready in XXX ms
   
   âžœ  Local:   http://localhost:5173/
   ```

5. Open in Browser
   Visit: http://localhost:5173
   
   You should see:
   â”œâ”€ Landing page with "Try Free (3 Images)" button
   â”œâ”€ Login/Sign up links
   â””â”€ Feature cards

================================================================================
PART 5: TESTING THE FULL FLOW
================================================================================

1. Test Anonymous Generation (Free Trial)
   â”œâ”€ Open: http://localhost:5173
   â”œâ”€ Click: "Try Free (3 Images)"
   â”œâ”€ Upload photos
   â”œâ”€ Select article type
   â”œâ”€ Generate
   â””â”€ Should see generated images

2. Test User Registration
   â”œâ”€ Click: "Login / Sign Up"
   â”œâ”€ Click: "Create Account" tab
   â”œâ”€ Sign up with email (test@example.com / password123)
   â””â”€ Should redirect to dashboard with 5 credits

3. Test Authenticated Generation
   â”œâ”€ On dashboard, click: "Create New Photoshoot"
   â”œâ”€ Upload images
   â”œâ”€ Generate (should cost 1 credit)
   â”œâ”€ Verify credit balance decreased to 4
   â””â”€ Generate again to test

4. Monitor Firestore
   â”œâ”€ Open: Firebase Console
   â”œâ”€ Click: Firestore Database
   â”œâ”€ Verify collections created:
   â”‚  â”œâ”€ users/ (with your user document)
   â”‚  â”œâ”€ photoshoots/ (with generated shoots)
   â”‚  â”œâ”€ transactions/ (under users)
   â”‚  â””â”€ anonUsers/ (if you tested anonymous)
   â””â”€ View user data to confirm credits changed

5. Check Logs
   â”œâ”€ Backend terminal should show:
   â”‚  â”œâ”€ Token verification logs
   â”‚  â”œâ”€ Generation requests
   â”‚  â””â”€ Credit deduction logs
   â””â”€ Frontend console (F12) should show API calls

================================================================================
PART 6: DEPLOYMENT (Railway)
================================================================================

## Deploy Backend to Railway

1. Create Railway Account
   â”œâ”€ Go to: https://railway.app
   â”œâ”€ Sign in with GitHub
   â””â”€ Pick Railway

2. Create New Project
   â”œâ”€ Click: "New Project"
   â”œâ”€ Select: "GitHub Repo"
   â”œâ”€ Authorize Railway with GitHub
   â””â”€ Select your repository

3. Create Backend Service
   â”œâ”€ In Railway dashboard
   â”œâ”€ Add Service
   â”œâ”€ Choose: "GitHub Repo"
   â”œâ”€ Select: fashion-photoshoot (backend folder)
   â””â”€ Configure runtime:
      â”œâ”€ Root Directory: backend
      â”œâ”€ Build Command: pip install -r requirements.txt
      â””â”€ Start Command: gunicorn -w 4 -b 0.0.0.0:8000 app.main:app

4. Set Environment Variables
   â”œâ”€ In Railway dashboard, go to: Variables
   â”œâ”€ Add all variables from backend/.env:
   â”‚  â”œâ”€ FIREBASE_PROJECT_ID
   â”‚  â”œâ”€ FIREBASE_STORAGE_BUCKET
   â”‚  â”œâ”€ NANO_BANANA_API_KEY
   â”‚  â”œâ”€ NANO_BANANA_MODEL_ID
   â”‚  â”œâ”€ FRONTEND_URL (set to your Vercel URL later)
   â”‚  â””â”€ (all Firebase credentials)
   â””â”€ Deploy

5. Get Backend URL
   â”œâ”€ In Railway dashboard
   â”œâ”€ Under Deployments, find Live URL
   â”œâ”€ Copy the URL (looks like: project-xxx.railway.app)
   â””â”€ Save for later

## Deploy Frontend to Vercel

1. Create Vercel Account
   â”œâ”€ Go to: https://vercel.com
   â”œâ”€ Sign in with GitHub
   â””â”€ Authorize Vercel

2. Import Project
   â”œâ”€ Click: "Add New..."
   â”œâ”€ Select: "Project"
   â”œâ”€ Select your fashion-photoshoot repository
   â”œâ”€ Set Root Directory: frontend
   â””â”€ Import

3. Set Environment Variables
   â”œâ”€ In Vercel dashboard, go to: Settings > Environment Variables
   â”œâ”€ Add all variables from frontend/.env.example:
   â”‚  â”œâ”€ VITE_FIREBASE_API_KEY
   â”‚  â”œâ”€ VITE_FIREBASE_PROJECT_ID
   â”‚  â”œâ”€ VITE_BACKEND_URL (set to your Railway URL)
   â”‚  â””â”€ (all Firebase config)
   â””â”€ Deploy

4. Update Backend FRONTEND_URL
   â”œâ”€ Go back to Railway dashboard
   â”œâ”€ Update FRONTEND_URL to your Vercel URL
   â””â”€ Redeploy backend

5. Test Production
   â”œâ”€ Visit your Vercel frontend URL
   â”œâ”€ Test complete flow
   â”œâ”€ Check error logs if issues
   â””â”€ Monitor Firestore for data

================================================================================
PART 7: SECURITY RULES (Firestore & Storage)
================================================================================

## Firestore Security Rules

Go to: Firebase Console > Firestore > Rules

Replace with:
```
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Users can only read/write their own data
    match /users/{userId} {
      allow read, write: if request.auth.uid == userId;
    }
    
    // Transactions accessible to owner only
    match /users/{userId}/transactions/{document=**} {
      allow read: if request.auth.uid == userId;
      allow write: if false; // Backend-only
    }
    
    // Photoshoots accessible to owner
    match /photoshoots/{userId}/{document=**} {
      allow read, write: if request.auth.uid == userId;
    }
    
    // Anonymous users data
    match /anonUsers/{document=**} {
      allow read: if true; // Only IP-hashed data
      allow write: if false; // Backend-only
    }
  }
}
```

## Firebase Storage Security Rules

Go to: Firebase Console > Storage > Rules

Replace with:
```
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Uploaded images - accessible to owner
    match /uploaded-images/{userId}/{allPaths=**} {
      allow read, write: if request.auth.uid == userId;
    }
    
    // Generated images - accessible to owner
    match /generated-images/{userId}/{allPaths=**} {
      allow read: if request.auth.uid == userId;
      allow write: if false; // Backend-only
    }
    
    // Anonymous images public (optional)
    match /generated-images/anon-{hash}/{allPaths=**} {
      allow read: if true;
      allow write: if false;
    }
  }
}
```

================================================================================
PART 8: OPTIONAL - PAYMENT GATEWAY SETUP
================================================================================

## JazzCash Integration

1. Register as JazzCash Merchant
   â”œâ”€ Go to: https://www.jazzcash.com.pk
   â”œâ”€ Business > Merchant Services
   â”œâ”€ Register account
   â””â”€ Get merchant credentials

2. Store Credentials
   ```
   In backend/.env:
   JAZZCASH_MERCHANT_ID=your-merchant-id
   JAZZCASH_PASSWORD=your-password
   JAZZCASH_INTEGRITY_KEY=your-key
   ```

## EasyPaisa Integration

1. Register as EasyPaisa Merchant
   â”œâ”€ Go to: https://www.easypaisa.com.pk
   â”œâ”€ Business > Merchant Portal
   â”œâ”€ Register and verify
   â””â”€ Get credentials

2. Store Credentials
   ```
   In backend/.env:
   EASYPAISA_MERCHANT_ID=your-id
   EASYPAISA_PASSWORD=your-password
   ```

================================================================================
TROUBLESHOOTING
================================================================================

Issue: "Firebase credentials not found"
â”œâ”€ Solution: Ensure firebase-credentials.json exists in backend/
â””â”€ Or set env variables instead

Issue: "Nano Banana API key invalid"
â”œâ”€ Solution: Check API key is correct in backend/.env
â””â”€ Test with curl to verify

Issue: "CORS errors on frontend"
â”œâ”€ Solution: Update ALLOWED_ORIGINS in backend/app/config.py
â”œâ”€ Add your Vercel frontend URL
â””â”€ Restart backend

Issue: "Storage permission denied"
â”œâ”€ Solution: Apply Firestore/Storage security rules (Part 7)
â””â”€ Verify security rules are deployed

Issue: "Vercel build failing"
â”œâ”€ Solution: Check frontend/.env is set in Vercel dashboard
â””â”€ Check Root Directory is set to "frontend"

================================================================================
SUPPORT & RESOURCES
================================================================================

Documentation:
â”œâ”€ Architecture: docs/ARCHITECTURE.md
â”œâ”€ API Reference: docs/API.md
â”œâ”€ Frontend README: frontend/README.md
â””â”€ Backend README: backend/README.md

External Links:
â”œâ”€ Firebase Docs: https://firebase.google.com/docs
â”œâ”€ SvelteKit Docs: https://kit.svelte.dev
â”œâ”€ FastAPI Docs: https://fastapi.tiangolo.com
â”œâ”€ Nano Banana: https://www.nanobana.com
â”œâ”€ Railway: https://railway.app/docs
â””â”€ Vercel: https://vercel.com/docs

Helpful Contacts:
â”œâ”€ Firebase Support: https://firebase.google.com/support
â”œâ”€ Railway Support: https://support.railway.app
â””â”€ Vercel Support: https://vercel.com/support

================================================================================
That's it! Your Fashion Photoshoot Studio is ready to use! ðŸŽ‰

For production, remember to:
âœ“ Rotate API keys regularly
âœ“ Monitor logs for errors
âœ“ Set proper CORS origins
âœ“ Enable HTTPS everywhere
âœ“ Regular database backups
âœ“ Monitor costs on all services

Happy building! ðŸš€
================================================================================
